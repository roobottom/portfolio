#figure {
  .space() {
    .break-min({
      width: unit((@grid-text-min + @grid-gap-min + @grid-pull-min) * @space / @base,rem);
    });
    .break-mid({
      width: unit(@grid-text-mid * @space / @base,rem);
      padding-right: unit((@grid-gap-mid + @grid-pull-mid) * @space / @base,rem);
    });
    .break-max({
      width: unit(@grid-text-max * @space / @base,rem);
      padding-right: unit((@grid-gap-max + @grid-pull-max) * @space / @base,rem);
    });
  }
}

.figure {

  //all figures
  margin-left: auto;
  margin-right: auto;

  #figure > .space;

  .space(margin-top,4);
  .break-min({
    .space(margin-top,8);
    .space(margin-bottom,8);
  });

  img {
    display: block;
    max-width: 100%;
    box-sizing: border-box;
  }

  &__caption {
    #type > #size > .sm;
    color: mix(@c_text,white);
    .space(margin-top,2);
    font-style: italic;
  }

  //side by side
  &.side-by-side {
    padding-right: 0;
    .break-min({
      width: unit((@grid-text-min + @grid-gap-min + @grid-pull-min) * @space / @base,rem);
    });
    .break-mid({
      display: flex;
      width: unit((@grid-text-mid + @grid-gap-mid + @grid-pull-mid) * @space / @base,rem);
      justify-content: space-between;
    });
    .break-max({
      display: flex;
      width: unit((@grid-text-max + @grid-gap-max + @grid-pull-max) * @space / @base,rem);
      justify-content: space-between;
    });

  }

  &.side-by-side &__images {
    padding-right: 0;
    .break-mid({
      width: unit(@grid-text-mid * @space / @base,rem);
    });
    .break-max({
      width: unit(@grid-text-max * @space / @base,rem);
    });
  }

  &.side-by-side &__caption {
    .break-mid({
      width: unit(@grid-pull-mid * @space / @base,rem);
    });
    .break-max({
      width: unit(@grid-pull-max * @space / @base,rem);
    });
    align-self: flex-end;
  }

  &.max {
    width: auto;
    padding: 0;
  }

  &.max &__caption {
    margin-left: auto;
    margin-right: auto;
    #figure > .space;
  }



  &.pull &__images {
    #grid > .text-and-pull;
  }

  &.right {
    float: right;
    width: unit( @grid-pull-min * @space/@base ,rem);
    .space(margin,0,0,2,2);

    .break-min({
      float: right;
      @known-widths: unit(((@grid-gap-min + @grid-text-min + @grid-pull-min) * @space) / @base, rem);
      margin-right: ~"calc(1 * (100% - @{known-widths}) / 2)";
    });


    .break-mid({

      width: unit( @grid-pull-mid * @space/@base ,rem);
      @known-widths: unit(((@grid-gap-mid + @grid-text-mid + @grid-pull-mid) * @space) / @base, rem);
      margin-right: ~"calc(1 * (100% - @{known-widths}) / 2)";
    });

    .break-max({
      width: unit( @grid-pull-max * @space/@base ,rem);
      @known-widths: unit(((@grid-gap-max + @grid-text-max + @grid-pull-max) * @space) / @base, rem);
      margin-right: ~"calc(1 * (100% - @{known-widths}) / 2)";
    });

    & ~ *:not(p):not(ul):not(ol) {clear: both;}
  }

  //-----gallery
  &__images--gallery {
    display: flex;
  }

  &__images--gallery &__image {
    .space(margin-right,2);
    &:last-child {margin-right: 0;}
    position: relative;
  }

  &__number {
    position: absolute;
    #type > #size > .sm;
    .space(padding,1,2);
    text-align: center;
    display: block;
    background-color: white;
    bottom: 0;
    right: 0;
  }



  //-----frames
  .frame--browser {
    border: 1px solid #ccc;
    .space(padding,.5);
    .break-min({
      .space(padding,1);
    });
    & + .figure__number {
      bottom: 1px;
      right: 1px;
    }
  }

  .frame--phone {
    .space(border-left-width,1);
    .space(border-right-width,1);
    .space(border-bottom-width,3);
    .space(border-top-width,2);
    border-radius: 13px;
    border-color: #FCFCFC;
    border-style: solid;
    background-color: #111111;
    padding: 2px;
    box-shadow: 0 0 0 1px #CCC, 0 0 4px fade(black,40%);
    .space(max-width,18);
    .break-min({
      .space(max-width,27);
      .space(border-left-width,1.5);
      .space(border-right-width,1.5);
      .space(border-bottom-width,6);
      .space(border-top-width,4);
    });
  }

  .frame--polaroid {
    padding: 3px;
    background-color: #F1F1F1;
    border: 10px solid white;
    border-bottom-width: 60px;
    box-shadow: 0 0 0 4px #D1D1D1, 0 0 0 6px white;
  }

}


//overrides per id
#jk-banner {
  @c: #275877;
  .figure__images {
    background-color: @c;
    background-image:
    linear-gradient(to bottom, rgba(255,255,255,0) 0%,rgba(255,255,255,.3) 100%),
    url(/images/wedding/cushion.png);
    border-top: 1px solid darken(@c,20%);
    .space(padding,3,0);
    display: flex;
    justify-content: center;
    box-shadow: inset 0 -10px 10px fade(black,20%);
    .break-min({
      justify-content: flex-start;
      .space(padding,6,0);
      > img {.space(margin-left,14);}
    });
  }

}

#nb-banner {

  .space(padding,6,0);
  .figure__images {
    justify-content: space-between;
  }
  .figure__image {
    padding: 0;
    //max-width: 200px;
    position: relative;
    z-index: -1;
    width: 25%;
  }


  .figure__image:nth-child(1) img {
    transform: rotate(-4.5deg);
  }
  .figure__image:nth-child(2) img {
    transform: rotate(2deg);
  }
  .figure__image:nth-child(3) img {
    transform: rotate(-3deg);
  }
  .figure__image:nth-child(4) img {
    transform: rotate(2.7deg);
    margin-right: 80px;
  }
}
